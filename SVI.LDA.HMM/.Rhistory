alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LAD(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
library(Rcpp)
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LAD(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
library(Rcpp)
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LAD(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LAD(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LAD(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LAD(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
install.packages("lda")
library(lda)
demo(lda)
cora.documents
cora.vocab
top.topic.words()
data("cora.documents")
cora.documents
cora.vocab
LDA.Dictionary<-function(X)
{
#l=5 the number of passes we run.
words=unlist(X);
y=rep(0,length(words));
H=hashmap(words,y);
H1=hashmap(H$keys(),1:length(H$keys()));
# Key=H1$keys();
# Values=H1$values();
# return(list(Key,Values));
return(H1);
}
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre, # the stop criteria
k # the number of top topics and words
)
{
D=length(X);   # the number of the document.
a=LDA.Dictionary(X);
Key=a$keys();
Value=a$values(); # get the dictionary and value
V=length(Key);
Lambda=matrix(rchisq(K*V,df=1,ncp=0),V); # random initial
#Lambda=matrix(rep(0.1,K*V),V);
##choose step size as 1/t.
top.words=matrix(rep(0,D*k),D) # initial the top.words
top.topics=matrix(rep(0,D*k),D)# initial the top.topics
gamma=matrix(rep(0,D*K),K);    # Allocate memory
phi=list()                     # initial the phi
phi1=list(1);
for (i in 1:n)           t[]
{
for (d in 1:D)
{
gamma[,d]=1;               # initial the gamma
gamma1=rep(0,K);           # instore the last data of gamma
Y=unlist(X[d]); # get the X[d];
w=matrix(rep(0,length(Y)*V),nrow=V);
mid=matrix(rep(0,length(Y)*K),nrow=length(Y));
mid_norm=mid;
while(norm(as.matrix(gamma[,d]-gamma1))>=pre) # stop criteria
{
gamma1=gamma[,d] # the last update of gamma
for (j in 1:length(Y)) # read each words in d-th document.
{
w[,j]=(Y[j]==Key); # the realization of multinormial(beta...)
p=a$find(Y[j]);
mid[j,]=exp(digamma(gamma[,d])+digamma(Lambda[p,])-digamma(colSums(Lambda)))
mid_norm[j,]=mid[j,]/sum(mid[j,]); # normalized
}
gamma[,d]=alpha+colSums(mid_norm); # update gamma
}
phi[[d]]=mid_norm; # update phi
lambda=eta+D*w%*%phi[[d]]; # update lambda_hat
#lambda=eta+D*w%*%mid_norm;
Lambda=(1-((i-1)*D+d)^(-1))*Lambda+((i-1)*D+d)^(-1)*lambda; # update lambda
}
}
for (i in 1:D)
{
top.words[i,]=order(colSums(phi[[i]]%*%t(Lambda)),decreasing=TRUE)[1:k];
top.topics[i,]=order(gamma[,i],decreasing=TRUE)[1:k];
}
return(list(Lambda,phi,gamma,top.words,top.topics));
}
X=list(c("home","mother"),c("father","dad","cat","it"))
K=100;
alpha=1/K;
eta=0.01;
n=10;
pre=0.1;
t=LDA.SVI(b,K,n,alpha=1/K,eta=0.01,pre=0.1,10)
b=list();
for (i in 1:2410)
{
d=cora.documents[[i]];
b[[i]]=rep(d[1,],d[2,]);
}
LDA.Dictionary<-function(X)
{
#l=5 the number of passes we run.
words=unlist(X);
y=rep(0,length(words));
H=hashmap(words,y);
H1=hashmap(H$keys(),1:length(H$keys()));
# Key=H1$keys();
# Values=H1$values();
# return(list(Key,Values));
return(H1);
}
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre, # the stop criteria
k # the number of top topics and words
)
{
D=length(X);   # the number of the document.
a=LDA.Dictionary(X);
Key=a$keys();
Value=a$values(); # get the dictionary and value
V=length(Key);
Lambda=matrix(rchisq(K*V,df=1,ncp=0),V); # random initial
#Lambda=matrix(rep(0.1,K*V),V);
##choose step size as 1/t.
top.words=matrix(rep(0,D*k),D) # initial the top.words
top.topics=matrix(rep(0,D*k),D)# initial the top.topics
gamma=matrix(rep(0,D*K),K);    # Allocate memory
phi=list()                     # initial the phi
phi1=list(1);
for (i in 1:n)           t[]
{
for (d in 1:D)
{
gamma[,d]=1;               # initial the gamma
gamma1=rep(0,K);           # instore the last data of gamma
Y=unlist(X[d]); # get the X[d];
w=matrix(rep(0,length(Y)*V),nrow=V);
mid=matrix(rep(0,length(Y)*K),nrow=length(Y));
mid_norm=mid;
while(norm(as.matrix(gamma[,d]-gamma1))>=pre) # stop criteria
{
gamma1=gamma[,d] # the last update of gamma
for (j in 1:length(Y)) # read each words in d-th document.
{
w[,j]=(Y[j]==Key); # the realization of multinormial(beta...)
p=a$find(Y[j]);
mid[j,]=exp(digamma(gamma[,d])+digamma(Lambda[p,])-digamma(colSums(Lambda)))
mid_norm[j,]=mid[j,]/sum(mid[j,]); # normalized
}
gamma[,d]=alpha+colSums(mid_norm); # update gamma
}
phi[[d]]=mid_norm; # update phi
lambda=eta+D*w%*%phi[[d]]; # update lambda_hat
#lambda=eta+D*w%*%mid_norm;
Lambda=(1-((i-1)*D+d)^(-1))*Lambda+((i-1)*D+d)^(-1)*lambda; # update lambda
}
}
for (i in 1:D)
{
top.words[i,]=order(colSums(phi[[i]]%*%t(Lambda)),decreasing=TRUE)[1:k];
top.topics[i,]=order(gamma[,i],decreasing=TRUE)[1:k];
}
return(list(Lambda,phi,gamma,top.words,top.topics));
}
X=list(c("home","mother"),c("father","dad","cat","it"))
K=100;
alpha=1/K;
eta=0.01;
n=10;
pre=0.1;
t=LDA.SVI(b,K,n,alpha=1/K,eta=0.01,pre=0.1,10)
b=list();
for (i in 1:2410)
{
d=cora.documents[[i]];
b[[i]]=rep(d[1,],d[2,]);
}
library(hashmap)
LDA.Dictionary<-function(X)
{
#l=5 the number of passes we run.
words=unlist(X);
y=rep(0,length(words));
H=hashmap(words,y);
H1=hashmap(H$keys(),1:length(H$keys()));
# Key=H1$keys();
# Values=H1$values();
# return(list(Key,Values));
return(H1);
}
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre, # the stop criteria
k # the number of top topics and words
)
{
D=length(X);   # the number of the document.
a=LDA.Dictionary(X);
Key=a$keys();
Value=a$values(); # get the dictionary and value
V=length(Key);
Lambda=matrix(rchisq(K*V,df=1,ncp=0),V); # random initial
#Lambda=matrix(rep(0.1,K*V),V);
##choose step size as 1/t.
top.words=matrix(rep(0,D*k),D) # initial the top.words
top.topics=matrix(rep(0,D*k),D)# initial the top.topics
gamma=matrix(rep(0,D*K),K);    # Allocate memory
phi=list()                     # initial the phi
phi1=list(1);
for (i in 1:n)           t[]
{
for (d in 1:D)
{
gamma[,d]=1;               # initial the gamma
gamma1=rep(0,K);           # instore the last data of gamma
Y=unlist(X[d]); # get the X[d];
w=matrix(rep(0,length(Y)*V),nrow=V);
mid=matrix(rep(0,length(Y)*K),nrow=length(Y));
mid_norm=mid;
while(norm(as.matrix(gamma[,d]-gamma1))>=pre) # stop criteria
{
gamma1=gamma[,d] # the last update of gamma
for (j in 1:length(Y)) # read each words in d-th document.
{
w[,j]=(Y[j]==Key); # the realization of multinormial(beta...)
p=a$find(Y[j]);
mid[j,]=exp(digamma(gamma[,d])+digamma(Lambda[p,])-digamma(colSums(Lambda)))
mid_norm[j,]=mid[j,]/sum(mid[j,]); # normalized
}
gamma[,d]=alpha+colSums(mid_norm); # update gamma
}
phi[[d]]=mid_norm; # update phi
lambda=eta+D*w%*%phi[[d]]; # update lambda_hat
#lambda=eta+D*w%*%mid_norm;
Lambda=(1-((i-1)*D+d)^(-1))*Lambda+((i-1)*D+d)^(-1)*lambda; # update lambda
}
}
for (i in 1:D)
{
top.words[i,]=order(colSums(phi[[i]]%*%t(Lambda)),decreasing=TRUE)[1:k];
top.topics[i,]=order(gamma[,i],decreasing=TRUE)[1:k];
}
return(list(Lambda,phi,gamma,top.words,top.topics));
}
X=list(c("home","mother"),c("father","dad","cat","it"))
K=100;
alpha=1/K;
eta=0.01;
n=10;
pre=0.1;
t=LDA.SVI(b,K,n,alpha=1/K,eta=0.01,pre=0.1,10)
cora.documents[[i]]
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LAD(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LAD(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LAD(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LAD(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LDA(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
library(RcppArmadillo)
sourceCpp(file='src/LDA.cpp')
LDA.SVI<-function(X, # the Input data
K, # the number of the topics
n, # the number of the passes
alpha, # the parameter of theta
eta, # the parameter of beta
pre # the stop criteria
)
{
len <- length(X)
names(X) <-as.character(1:len)
Y <- SVI_LDA(X,K,n,alpha,eta,pre)
print(Y)
}
X=list(c('home','mother','mother','house'),c('father','dad','cat','dad'))
K=2;
alpha=1/K;
eta=0.01;
n=2;
pre=0.1;
t=LDA.SVI(X,K,n,alpha=1/K,eta=0.01,pre=0.1)
